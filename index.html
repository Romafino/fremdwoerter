<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#4A90E2" />
  <!-- iOS Vollbild -->
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
  <!-- Manifest (relativ, damit es auf GitHub/Netlify klappt) -->
  <link rel="manifest" href="manifest.webmanifest" />
  <title>Fremdw√∂rter Trainer - Klasse 11</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    :root{--primary:#4A90E2;--secondary:#50E3C2;--success:#7ED321;--error:#D0021B;--dark-bg:#1a1a2e;--card-bg:#16213e;--text-primary:#fff;--text-secondary:#a8a8a8;--safe-top:env(safe-area-inset-top);--safe-bottom:env(safe-area-inset-bottom)}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,#1a1a2e 0%,#0f1123 100%);color:var(--text-primary);min-height:100vh;padding-bottom:var(--safe-bottom)}
    .header{background:rgba(26,26,46,.95);padding:calc(1rem + var(--safe-top)) 1rem 1rem;box-shadow:0 2px 20px rgba(0,0,0,.3)}
    .header-content{max-width:1200px;margin:0 auto;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap}
    h1{font-size:1.5rem;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .stats{display:flex;gap:1.5rem}.stat-item{text-align:center}.stat-value{font-size:1.3rem;font-weight:700;color:var(--secondary)}.stat-label{font-size:.7rem;color:var(--text-secondary)}
    .container{max-width:1200px;margin:2rem auto;padding:0 1rem}
    .mode-selector{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem}
    .mode-card{background:var(--card-bg);border-radius:15px;padding:2rem;cursor:pointer;transition:.3s;border:2px solid transparent}
    .mode-card:hover{transform:translateY(-5px);border-color:var(--primary);box-shadow:0 10px 30px rgba(74,144,226,.3)}
    .lesson-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:1rem;margin:2rem 0}
    .lesson-btn{padding:1rem;background:var(--card-bg);border:2px solid transparent;border-radius:10px;color:#fff;cursor:pointer;transition:.3s;width:100%}
    .lesson-btn:hover{border-color:var(--primary);transform:scale(1.05)}.lesson-btn.completed{border-color:var(--success);background:rgba(126,211,33,.1)}
    .card-container{perspective:1000px;height:400px;margin:2rem 0}
    .card{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform .6s;cursor:pointer;will-change:transform}
    .card.flipped{transform:rotateY(180deg)}
    .card-face{position:absolute;width:100%;height:100%;backface-visibility:hidden;-webkit-backface-visibility:hidden;border-radius:20px;padding:2rem;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;background:var(--card-bg);border:2px solid rgba(255,255,255,.1)}
    .card-back{transform:rotateY(180deg);background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)}
    .word{font-size:2.5rem;font-weight:700;margin-bottom:1rem}.definition{font-size:1.2rem;margin-bottom:1rem}.example{font-style:italic;background:rgba(0,0,0,.2);padding:1rem;border-radius:10px;margin:1rem 0}
    .nav-buttons{display:flex;justify-content:center;gap:1rem;margin:2rem 0;flex-wrap:wrap}
    .btn{padding:.8rem 1.5rem;background:var(--primary);color:#fff;border:none;border-radius:25px;cursor:pointer;font-size:1rem;transition:.3s}
    .btn:hover{transform:scale(1.05);box-shadow:0 5px 15px rgba(74,144,226,.4)}.btn:disabled{opacity:.5;cursor:not-allowed}
    .progress-bar{width:100%;height:30px;background:rgba(255,255,255,.1);border-radius:15px;overflow:hidden;margin:1rem 0}
    .progress-fill{height:100%;background:linear-gradient(90deg,var(--primary),var(--secondary));transition:width .5s;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700}
    .quiz-question{background:var(--card-bg);padding:2rem;border-radius:15px;margin:2rem 0}
    .quiz-options{display:grid;gap:1rem;margin:1.5rem 0}
    .quiz-option{padding:1rem;background:rgba(255,255,255,.05);border:2px solid transparent;border-radius:10px;cursor:pointer;transition:.3s;text-align:left}
    .quiz-option:hover:not(.disabled){background:rgba(255,255,255,.1);border-color:var(--primary)}
    .quiz-option.correct{background:rgba(126,211,33,.2);border-color:var(--success)}
    .quiz-option.incorrect{background:rgba(208,2,27,.2);border-color:var(--error)}
    .results{background:var(--card-bg);padding:2rem;border-radius:15px;text-align:center}
    .score{font-size:3rem;font-weight:700;margin:1rem 0;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text}
    .hidden{display:none !important}
    .mode-card:focus-visible,.card:focus-visible,.btn:focus-visible,.lesson-btn:focus-visible,.quiz-option:focus-visible{outline:2px solid var(--secondary);outline-offset:4px}
    @media (prefers-reduced-motion: reduce){.card,.btn,.mode-card,.lesson-btn{transition:none;transform:none}}
    #iosInstallHint{position:fixed;left:1rem;right:1rem;bottom:calc(1rem + var(--safe-bottom));background:rgba(22,33,62,.95);border:1px solid rgba(255,255,255,.1);color:#fff;padding:.8rem 1rem;border-radius:12px;z-index:1000;text-align:center}
    #iosInstallHint.hidden{display:none}
  </style>
</head>
<body>
  <header class="header">
    <div class="header-content">
      <h1>üìö Fremdw√∂rter Trainer</h1>
      <div class="stats">
        <div class="stat-item"><div class="stat-value" id="totalWords">0</div><div class="stat-label">W√∂rter</div></div>
        <div class="stat-item"><div class="stat-value" id="learnedWords">0</div><div class="stat-label">Gelernt</div></div>
        <div class="stat-item"><div class="stat-value" id="streakCount">0</div><div class="stat-label">Serie</div></div>
      </div>
    </div>
  </header>

  <div class="container">
    <div id="mainMenu">
      <div class="mode-selector">
        <div class="mode-card" id="modeLearn" role="button" tabindex="0"><h3>üìñ Lernen</h3><p>Karteikarten in Lektionen zu je 10‚Äì15 Begriffen</p></div>
        <div class="mode-card" id="modeQuiz" role="button" tabindex="0"><h3>‚úÖ Lernkontrolle</h3><p>Teste dein Wissen mit 5 Fragen pro Lektion</p></div>
        <div class="mode-card" id="modeFinal" role="button" tabindex="0"><h3>üéØ Abschlusstest</h3><p>25 zuf√§llige Fragen aus allen Themen</p></div>
        <div class="mode-card" id="modeProgress" role="button" tabindex="0"><h3>üìä Fortschritt</h3><p>Sieh deinen Lernfortschritt und Statistiken</p></div>
      </div>
    </div>

    <div id="learningMode" class="hidden">
      <h2>W√§hle eine Lektion:</h2>
      <div class="lesson-grid" id="lessonGrid"></div>
      <div id="cardView" class="hidden" aria-live="polite">
        <div class="card-container">
          <div class="card" id="flashcard" role="button" tabindex="0">
            <div class="card-face card-front">
              <div class="word" id="wordFront"></div>
              <p style="margin-top:2rem;color:var(--text-secondary)">Tippe oder dr√ºcke Enter/Leertaste zum Umdrehen</p>
            </div>
            <div class="card-face card-back">
              <div class="definition" id="definition"></div>
              <div class="example" id="example"></div>
            </div>
          </div>
        </div>
        <div class="progress-bar"><div class="progress-fill" id="progressBar">0%</div></div>
        <div class="nav-buttons">
          <button class="btn" id="prevBtn" type="button">‚Üê Zur√ºck</button>
          <button class="btn" id="markLearnedBtn" type="button">‚úì Gelernt</button>
          <button class="btn" id="nextBtn" type="button">Weiter ‚Üí</button>
          <button class="btn" id="backToLessonsBtn" type="button">Lektionen</button>
        </div>
      </div>
    </div>

    <div id="quizMode" class="hidden">
      <h2 id="quizTitle">Quiz</h2>
      <div id="quizContent" aria-live="polite"></div>
      <div class="nav-buttons"><button class="btn" id="backToMenuBtn" type="button">Zur√ºck zum Men√º</button></div>
    </div>

    <div id="progressView" class="hidden">
      <div class="results">
        <h2>üìä Dein Fortschritt</h2>
        <div id="progressDetails"></div>
        <div class="nav-buttons">
          <button class="btn" id="progressBackBtn" type="button">Zur√ºck</button>
          <button class="btn" id="resetProgressBtn" type="button">Fortschritt zur√ºcksetzen</button>
        </div>
      </div>
    </div>
  </div>

  <div id="iosInstallHint" class="hidden">Tippe auf <span>Teilen</span> ‚Üí <span>‚ÄûZum Home-Bildschirm‚Äú</span>, um die App zu installieren.</div>

  <script>
    // --- Datenbank (kleine Demo) ---
    const wordsDatabase = [
      {"Fremdwort":"Allegorie","Erl√§uterung":"Bildhafte Darstellung eines abstrakten Begriffs","Beispielsatz":"Die Figur mit Waage steht als Allegorie f√ºr Gerechtigkeit.","Thema":"Sprache & Literatur"},
      {"Fremdwort":"Alliteration","Erl√§uterung":"Gleicher Anfangslaut bei benachbarten W√∂rtern","Beispielsatz":`‚ÄûMilch macht m√ºde M√§nner munter‚Äú ist eine Alliteration.`, "Thema":"Sprache & Literatur"},
      {"Fremdwort":"Metapher","Erl√§uterung":"√úbertragener, bildhafter Ausdruck","Beispielsatz":`‚ÄûFels in der Brandung‚Äú ist eine Metapher.`, "Thema":"Sprache & Literatur"},
      {"Fremdwort":"Demokratie","Erl√§uterung":"Staatsform mit Mitbestimmung der B√ºrger","Beispielsatz":"In der Demokratie w√§hlen B√ºrger ihre Vertreter.","Thema":"Politik & Gesellschaft"},
      {"Fremdwort":"Diktatur","Erl√§uterung":"Herrschaft ohne freie Wahlen","Beispielsatz":"In der Diktatur ist Kritik gef√§hrlich.","Thema":"Politik & Gesellschaft"},
      {"Fremdwort":"Inflation","Erl√§uterung":"Allgemeiner Preisanstieg","Beispielsatz":"Durch Inflation wird der Einkauf teurer.","Thema":"Wirtschaft"},
      {"Fremdwort":"Rezession","Erl√§uterung":"Wirtschaftsabschwung","Beispielsatz":"In der Rezession steigt die Arbeitslosigkeit.","Thema":"Wirtschaft"},
      {"Fremdwort":"Photosynthese","Erl√§uterung":"Aufbau von Zucker aus CO‚ÇÇ und Wasser mit Licht","Beispielsatz":"Durch Photosynthese entsteht Sauerstoff.","Thema":"Naturwissenschaften"}
    ];

    // --- State & Helpers ---
    let currentLesson=[], currentCardIndex=0, currentQuiz=[], currentQuizIndex=0, score=0;
    let learned=JSON.parse(localStorage.getItem('learned')||'[]');
    let completedLessons=JSON.parse(localStorage.getItem('completedLessons')||'[]');
    let currentLessonIndex=null;
    const $=s=>document.querySelector(s);
    const el=(t,p={},...c)=>{const e=document.createElement(t);Object.assign(e,p);c.forEach(x=>e.appendChild(typeof x==='string'?document.createTextNode(x):x));return e;}
    const shuffle=a=>{for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];}return a;}

    function setView(ids=[]){['mainMenu','learningMode','quizMode','progressView'].forEach(id=>document.getElementById(id).classList.toggle('hidden',!ids.includes(id)));}
    function updateStats(){
      $('#totalWords').textContent=wordsDatabase.length;
      $('#learnedWords').textContent=learned.length;
      const today=new Date().toDateString(); const last=localStorage.getItem('lastSessionDate');
      let streak=Number(localStorage.getItem('streak')||'0');
      if(last!==today){streak=last?streak+1:1;localStorage.setItem('lastSessionDate',today);localStorage.setItem('streak',String(streak));}
      $('#streakCount').textContent=String(streak);
    }

    function startLearning(){ setView(['learningMode']); document.getElementById('cardView').classList.remove('hidden'); currentLesson=wordsDatabase.slice(0,Math.min(12,wordsDatabase.length)); currentCardIndex=0; showCard(); }
    function showCard(){ const w=currentLesson[currentCardIndex]; $('#wordFront').textContent=w.Fremdwort; $('#definition').textContent=w.Erl√§uterung; $('#example').textContent=w.Beispielsatz; $('#flashcard').classList.remove('flipped'); updateProgress(); updateNavButtons(); }
    function flipCard(){ $('#flashcard').classList.toggle('flipped'); }
    function nextCard(){ if(currentCardIndex<currentLesson.length-1){ currentCardIndex++; showCard(); } }
    function previousCard(){ if(currentCardIndex>0){ currentCardIndex--; showCard(); } }
    function markLearned(){
      const word=currentLesson[currentCardIndex].Fremdwort;
      if(!learned.includes(word)){ learned.push(word); localStorage.setItem('learned',JSON.stringify(learned)); updateStats(); }
      if(currentCardIndex<currentLesson.length-1){ nextCard(); } else { alert('Lektion abgeschlossen! üéâ'); setView(['mainMenu']); }
    }
    function updateProgress(){ const p=Math.round((currentCardIndex+1)/currentLesson.length*100); const bar=$('#progressBar'); bar.style.width=p+'%'; bar.textContent=p+'%'; }
    function updateNavButtons(){ $('#prevBtn').disabled=currentCardIndex===0; $('#nextBtn').disabled=currentCardIndex===currentLesson.length-1; }

    // Quiz (kurz)
    function startQuiz(){ setView(['quizMode']); $('#quizTitle').textContent='Quiz'; currentQuiz=generateQuizQuestions(5); currentQuizIndex=0; score=0; showQuizQuestion(); }
    function generateQuizQuestions(n){ const pool=shuffle([...wordsDatabase]).slice(0,Math.min(n,wordsDatabase.length)); return pool.map(w=>{const d=shuffle(wordsDatabase.filter(x=>x!==w)).slice(0,3).map(x=>x.Erl√§uterung); const options=shuffle([w.Erl√§uterung,...d]); return {word:w,options,correctIndex:options.indexOf(w.Erl√§uterung)}});}
    function showQuizQuestion(){ const c=$('#quizContent'); c.textContent=''; if(currentQuizIndex>=currentQuiz.length) return showQuizResults(); const q=currentQuiz[currentQuizIndex];
      const box=el('div',{className:'quiz-question'}); box.appendChild(el('h3',{},`Frage ${currentQuizIndex+1} von ${currentQuiz.length}`));
      const p=el('p',{style:'font-size:1.5rem;margin:1rem 0;'}); p.append('Was bedeutet: ',el('strong',{},q.word.Fremdwort),'?'); box.appendChild(p);
      const wrap=el('div',{className:'quiz-options'}); q.options.forEach((t,i)=>{const b=el('button',{className:'quiz-option',type:'button'},t); b.onclick=()=>checkAnswer(i); wrap.appendChild(b);}); box.appendChild(wrap); c.appendChild(box);}
    function checkAnswer(sel){ const q=currentQuiz[currentQuizIndex]; document.querySelectorAll('.quiz-option').forEach((o,i)=>{o.classList.add('disabled'); if(i===q.correctIndex) o.classList.add('correct'); if(i===sel&&sel!==q.correctIndex) o.classList.add('incorrect');}); if(sel===q.correctIndex) score++; setTimeout(()=>{currentQuizIndex++;showQuizQuestion();},1200); }
    function showQuizResults(){ const c=$('#quizContent'); c.textContent=''; const w=el('div',{className:'results'}); w.append(el('h2',{},'Quiz abgeschlossen!'),el('div',{className:'score'},`${score}/${currentQuiz.length}`),el('p',{},`Du hast ${Math.round(score/currentQuiz.length*100)}% richtig!`)); c.appendChild(w); }

    // iOS-Hinweis + Service Worker
    function maybeShowIosInstallHint(){ const isiOS=/iphone|ipad|ipod/i.test(navigator.userAgent); const standalone=window.matchMedia('(display-mode: standalone)').matches||navigator.standalone; if(isiOS && !standalone) document.getElementById('iosInstallHint').classList.remove('hidden'); }
    function registerSW(){ if('serviceWorker' in navigator){ window.addEventListener('load', ()=> navigator.serviceWorker.register('sw.js').catch(console.error)); } }

    // Events
    window.addEventListener('DOMContentLoaded', ()=>{
      updateStats(); maybeShowIosInstallHint(); registerSW();
      document.getElementById('modeLearn').onclick=startLearning;
      document.getElementById('modeQuiz').onclick=startQuiz;
      document.getElementById('modeFinal').onclick=()=>{ setView(['quizMode']); document.getElementById('quizTitle').textContent='Abschlusstest'; currentQuiz=generateQuizQuestions(Math.min(25,wordsDatabase.length)); currentQuizIndex=0; score=0; showQuizQuestion(); };
      document.getElementById('modeProgress').onclick=()=>{ setView(['progressView']); const d=document.getElementById('progressDetails'); const pct=Math.round((learned.length/wordsDatabase.length)*100); d.innerHTML=`<div class="score">${pct}%</div><p>Du hast ${learned.length} von ${wordsDatabase.length} W√∂rtern gelernt!</p><div class="progress-bar" style="margin:2rem auto;max-width:400px;"><div class="progress-fill" style="width:${pct}%">${pct}%</div></div>`; };
      document.getElementById('flashcard').onclick=flipCard;
      document.getElementById('prevBtn').onclick=previousCard;
      document.getElementById('nextBtn').onclick=nextCard;
      document.getElementById('markLearnedBtn').onclick=markLearned;
      document.getElementById('backToLessonsBtn').onclick=()=>{ document.getElementById('cardView').classList.add('hidden'); setView(['learningMode']); };
      document.getElementById('backToMenuBtn').onclick=()=>setView(['mainMenu']);
      document.getElementById('progressBackBtn').onclick=()=>setView(['mainMenu']);
      document.getElementById('resetProgressBtn').onclick=()=>{ if(confirm('Fortschritt wirklich zur√ºcksetzen?')){ localStorage.clear(); learned=[]; completedLessons=[]; updateStats(); setView(['mainMenu']); } };
    });
  </script>
</body>
</html>
